# **Dom√≠nio 1: Cria√ß√£o de arquiteturas seguras**, que representa 30% do exame SAA-C03. Esse dom√≠nio abrange os seguintes t√≥picos principais:

### 1.1 Projetar cargas de trabalho seguras e com alto desempenho
- Implementa√ß√£o de **controle de acesso** com IAM:
  - IAM Users, Groups, Roles e Policies (Least Privilege)
  - IAM Identity Center (SSO)
  - AWS STS (Session Tokens)
- Uso de **seguran√ßa em rede**:
  - Security Groups vs NACLs
  - AWS WAF e AWS Shield
  - AWS Network Firewall
- Prote√ß√£o de dados com **criptografia**:
  - AWS KMS (gerenciamento de chaves)
  - AWS Secrets Manager e Parameter Store (armazenamento seguro de credenciais)
  - Criptografia em repouso (S3, RDS, EBS) e em tr√¢nsito (TLS)
- Pr√°ticas de seguran√ßa para **banco de dados e armazenamento**:
  - Amazon RDS IAM authentication
  - Controle de acesso no S3 (Bucket Policies, Block Public Access)

### 1.2 Aplicar princ√≠pios de seguran√ßa para arquiteturas baseadas em nuvem
- **Shared Responsibility Model** (Modelo de Responsabilidade Compartilhada)
- **Melhores pr√°ticas de seguran√ßa para cargas de trabalho**:
  - AWS Well-Architected Framework ‚Äì Pilar de Seguran√ßa
  - Princ√≠pio do **Least Privilege** (Menor Privil√©gio)
  - Uso de **MFA (Multi-Factor Authentication)**
- **Gerenciamento de logs e auditoria**:
  - AWS CloudTrail (registro de atividades da conta)
  - AWS Config (compliance e mudan√ßas na configura√ß√£o)
  - Amazon CloudWatch Logs e AWS Security Hub (monitoramento e alertas)

### 1.3 Garantir prote√ß√£o contra falhas e ataques cibern√©ticos
- Implementa√ß√£o de **alta disponibilidade e resili√™ncia**:
  - Multi-AZ e Read Replicas no RDS
  - Backup e recupera√ß√£o com AWS Backup
  - Disaster Recovery: Pilot Light, Warm Standby, Multi-site
- **Mitiga√ß√£o de DDoS e amea√ßas**:
  - AWS Shield Standard e Advanced
  - CloudFront para prote√ß√£o contra ataques na camada de aplica√ß√£o
  - AWS WAF para bloquear tr√°fego malicioso


Beleza! Vamos come√ßar com **IAM (Identity and Access Management)**, que √© um dos servi√ßos mais cr√≠ticos para controle de acesso na AWS.  

---

## üîπ **IAM: Identity and Access Management**
O **AWS IAM (Identity and Access Management)** permite gerenciar quem pode acessar os recursos da AWS e o que essas entidades podem fazer. Ele √© baseado nos princ√≠pios de **Least Privilege (Menor Privil√©gio)** e **controle granular de permiss√µes**.

### üìå **1. IAM Users, Groups, Roles e Policies**  

### üîπ **IAM Users (Usu√°rios)**
- S√£o **identidades individuais** dentro da AWS.
- Associados a credenciais como:
  - Nome de usu√°rio e senha (para acessar o console AWS)
  - Chaves de acesso (para uso na AWS CLI, SDKs)
- Seguem o **princ√≠pio do menor privil√©gio** (Least Privilege).
- Podem receber permiss√µes diretamente ou atrav√©s de **Grupos**.

### üîπ **IAM Groups (Grupos)**
- **Conjunto de usu√°rios** que compartilham permiss√µes comuns.
- Exemplo:
  - Grupo `Administrators`: usu√°rios com permiss√µes administrativas.
  - Grupo `Developers`: usu√°rios com acesso a servi√ßos como Lambda e S3.
- Em vez de atribuir permiss√µes individualmente, voc√™ atribui ao grupo e todos os usu√°rios herdam essas permiss√µes.

### üîπ **IAM Roles (Fun√ß√µes)**
- **Identidades que n√£o pertencem a um usu√°rio espec√≠fico**.
- Permitem que **servi√ßos da AWS, aplica√ß√µes ou usu√°rios externos** assumam permiss√µes tempor√°rias.
- **Exemplos:**
  - Uma aplica√ß√£o em **EC2** pode assumir um **Role** para acessar um **S3 Bucket** sem armazenar credenciais.
  - Usu√°rios federados podem assumir um **Role** via SSO.

### üîπ **IAM Policies (Pol√≠ticas)**
- S√£o **documentos JSON** que definem permiss√µes.
- Podem ser anexadas a **Users, Groups e Roles**.
- Dois tipos principais:
  - **Managed Policies (Gerenciadas)** ‚Üí Criadas pela AWS ou pelo usu√°rio.
  - **Inline Policies (Embutidas)** ‚Üí Definidas diretamente dentro de um usu√°rio, grupo ou role.
- Exemplo de **Policy JSON** que permite acesso somente leitura ao S3:
  ```json
  {
    "Version": "2012-10-17",
    "Statement": [
      {
        "Effect": "Allow",
        "Action": "s3:ListBucket",
        "Resource": "arn:aws:s3:::meu-bucket"
      }
    ]
  }
  ```

---

## üîπ **IAM Identity Center (SSO)**
- Gerencia **Single Sign-On (SSO)** para **v√°rias contas AWS** e aplica√ß√µes SaaS.
- Permite usar **Microsoft Active Directory**, **Okta**, **Google Workspace**, etc., para autentica√ß√£o.
- Benef√≠cios:
  - **Login √∫nico** para m√∫ltiplas contas AWS.
  - **Atribui√ß√£o de permiss√µes centralizada**.
  - **Integra√ß√£o com MFA** para mais seguran√ßa.

---

## üîπ **AWS STS (Security Token Service)**
- Fornece **credenciais tempor√°rias** para acessar a AWS.
- Essas credenciais:
  - Expiram automaticamente (por padr√£o, em 1 hora).
  - N√£o precisam ser armazenadas permanentemente.
- Usado para:
  - **Cross-account access** (acesso entre contas AWS).
  - **Usu√°rios federados** (SSO e Active Directory).
  - **Aplica√ß√µes que precisam de credenciais tempor√°rias**.

### üîπ **Exemplo de Uso do STS**
1. Um usu√°rio assume um **IAM Role**.
2. O STS gera **credenciais tempor√°rias**.
3. A aplica√ß√£o usa essas credenciais para acessar um recurso AWS.

Exemplo de chamada √† AWS CLI para assumir um role via STS:
```sh
aws sts assume-role --role-arn "arn:aws:iam::123456789012:role/MeuRole" --role-session-name "MinhaSessao"
```

---

## üî• **Resumo**
| Componente | Descri√ß√£o |
|------------|------------|
| **IAM Users** | Usu√°rios individuais com permiss√µes espec√≠ficas. |
| **IAM Groups** | Conjunto de usu√°rios que compartilham permiss√µes. |
| **IAM Roles** | Identidades que permitem assumir permiss√µes tempor√°rias. |
| **IAM Policies** | Definem permiss√µes em JSON. |
| **IAM Identity Center (SSO)** | Gerencia login √∫nico para v√°rias contas. |
| **AWS STS** | Gera credenciais tempor√°rias para acessos seguros. |

---

Com certeza! Vamos criar exemplos pr√°ticos para cada parte do primeiro conte√∫do sobre **IAM Users, Groups, Roles, Policies, IAM Identity Center e AWS STS**.

---

# ‚úÖ **1. Configura√ß√£o de IAM Users, Groups, Roles e Policies**

### **1Ô∏è‚É£ Criando um usu√°rio IAM via AWS CLI**
```sh
aws iam create-user --user-name DevUser
```
Isso cria um usu√°rio chamado **DevUser**.

### **2Ô∏è‚É£ Criando um grupo e adicionando permiss√µes**
```sh
aws iam create-group --group-name Developers
```
Agora, adicionamos uma pol√≠tica gerenciada de **acesso ao S3** ao grupo:
```sh
aws iam attach-group-policy --group-name Developers --policy-arn arn:aws:iam::aws:policy/AmazonS3FullAccess
```

Adicionamos o usu√°rio ao grupo:
```sh
aws iam add-user-to-group --user-name DevUser --group-name Developers
```
‚úÖ **Agora o usu√°rio DevUser tem acesso ao S3 porque pertence ao grupo Developers!**

---

# ‚úÖ **2. Criando uma Role para EC2 acessar o S3**
Vamos criar uma **IAM Role** que permite uma inst√¢ncia **EC2 acessar um bucket S3**.

### **1Ô∏è‚É£ Criando uma pol√≠tica JSON personalizada**
Criamos um arquivo chamado `s3-access-policy.json`:
```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": "s3:*",
            "Resource": "arn:aws:s3:::meu-bucket/*"
        }
    ]
}
```
Agora criamos a pol√≠tica na AWS:
```sh
aws iam create-policy --policy-name S3AccessPolicy --policy-document file://s3-access-policy.json
```
Isso retorna um ARN parecido com:
```
"Arn": "arn:aws:iam::123456789012:policy/S3AccessPolicy"
```

### **2Ô∏è‚É£ Criando a Role para EC2**
Criamos uma Role chamada `EC2S3AccessRole`:
```sh
aws iam create-role --role-name EC2S3AccessRole --assume-role-policy-document file://trust-policy.json
```
O arquivo `trust-policy.json` define que **somente inst√¢ncias EC2 podem assumir a Role**:
```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Principal": {
                "Service": "ec2.amazonaws.com"
            },
            "Action": "sts:AssumeRole"
        }
    ]
}
```

Agora anexamos a pol√≠tica de acesso ao S3 √† Role:
```sh
aws iam attach-role-policy --role-name EC2S3AccessRole --policy-arn arn:aws:iam::123456789012:policy/S3AccessPolicy
```

### **3Ô∏è‚É£ Associando a Role a uma inst√¢ncia EC2**
```sh
aws ec2 associate-iam-instance-profile --instance-id i-1234567890abcdef0 --iam-instance-profile Name=EC2S3AccessRole
```
‚úÖ Agora, qualquer aplica√ß√£o rodando na EC2 pode acessar o bucket S3 sem precisar de credenciais fixas!

---

# ‚úÖ **3. AWS STS (Security Token Service)**
O **STS** permite assumir um Role temporariamente sem armazenar credenciais permanentes.

### **1Ô∏è‚É£ Criando um Role para acesso tempor√°rio**
Criamos uma pol√≠tica para o Role:
```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Effect": "Allow",
            "Action": "s3:ListBucket",
            "Resource": "arn:aws:s3:::meu-bucket"
        }
    ]
}
```
Criamos a Role com:
```sh
aws iam create-role --role-name TemporaryS3AccessRole --assume-role-policy-document file://trust-policy.json
```
Anexamos a pol√≠tica ao Role:
```sh
aws iam attach-role-policy --role-name TemporaryS3AccessRole --policy-arn arn:aws:iam::aws:policy/AmazonS3ReadOnlyAccess
```

### **2Ô∏è‚É£ Assumindo a Role com STS**
```sh
aws sts assume-role --role-arn "arn:aws:iam::123456789012:role/TemporaryS3AccessRole" --role-session-name "TemporarySession"
```
Isso retorna credenciais tempor√°rias:
```json
{
    "Credentials": {
        "AccessKeyId": "ASIA...",
        "SecretAccessKey": "abcd...",
        "SessionToken": "FQoGZXIvYXdz...",
        "Expiration": "2025-02-18T12:00:00Z"
    }
}
```
Agora podemos configurar essas credenciais tempor√°rias no ambiente para acessar o S3.

---

# üöÄ **Conclus√£o**
‚úÖ Criamos um **usu√°rio IAM e grupo** com acesso ao S3.  
‚úÖ Criamos uma **Role** para EC2 acessar o S3 sem credenciais fixas.  
‚úÖ Utilizamos **AWS STS** para acessar um recurso de forma tempor√°ria.

√ìtimo! Agora vamos falar sobre **seguran√ßa de rede na AWS**, abordando **Security Groups, NACLs, AWS WAF, AWS Shield e AWS Network Firewall**.  

---

# üîπ **2. Uso de Seguran√ßa em Rede na AWS**

A AWS fornece v√°rias camadas de seguran√ßa para proteger sua infraestrutura de rede. Vamos entender os principais servi√ßos e quando usar cada um.

---

## ‚úÖ **1. Security Groups vs NACLs**  

### üîπ **Security Groups (SG)**
- **Funcionam a n√≠vel de inst√¢ncia** (por exemplo, EC2, RDS, Lambda com VPC).
- **S√£o stateful** (respostas a tr√°fegos permitidos s√£o automaticamente permitidas).
- **Regras s√≥ permitem tr√°fego** (n√£o bloqueiam, apenas liberam portas e IPs espec√≠ficos).
- **Atribu√≠dos a inst√¢ncias individuais**.
- **Avaliados em conjunto** ‚Üí Se uma regra permitir, o tr√°fego √© aceito.

üìå **Exemplo: Criando um Security Group para EC2**
```sh
aws ec2 create-security-group --group-name MeuSG --description "Security Group para Web Server"
```
Adicionando regras para permitir tr√°fego HTTP e SSH:
```sh
aws ec2 authorize-security-group-ingress --group-name MeuSG --protocol tcp --port 80 --cidr 0.0.0.0/0
aws ec2 authorize-security-group-ingress --group-name MeuSG --protocol tcp --port 22 --cidr 192.168.1.0/24
```
‚úÖ Permite HTTP de qualquer IP e SSH apenas da rede interna.

---

### üîπ **Network ACLs (NACLs)**
- **Funcionam a n√≠vel de Subnet (VPC)**.
- **S√£o stateless** (requisi√ß√µes e respostas precisam de regras separadas).
- **Podem permitir ou bloquear tr√°fego**.
- **S√£o aplicadas em ordem num√©rica (rule number)**.
- **Avalia√ß√£o sequencial** ‚Üí Assim que uma regra bate, ele para de verificar as outras.

üìå **Exemplo: Criando uma NACL para uma Subnet**
```sh
aws ec2 create-network-acl --vpc-id vpc-12345678
```
Adicionando regras para permitir HTTP e SSH:
```sh
aws ec2 create-network-acl-entry --network-acl-id acl-12345678 --rule-number 100 --protocol tcp --port-range From=80,To=80 --egress --cidr-block 0.0.0.0/0 --rule-action allow
aws ec2 create-network-acl-entry --network-acl-id acl-12345678 --rule-number 110 --protocol tcp --port-range From=22,To=22 --egress --cidr-block 192.168.1.0/24 --rule-action allow
```
‚úÖ Permite HTTP globalmente e SSH apenas da rede interna.

üìå **Resumo: Security Group vs NACLs**
| Caracter√≠stica | Security Group | NACL |
|--------------|---------------|------|
| **N√≠vel** | Inst√¢ncia (EC2, RDS) | Subnet (VPC) |
| **Stateful?** | Sim | N√£o |
| **Permite/Bloqueia?** | Apenas permite | Permite e bloqueia |
| **Ordem de Avalia√ß√£o** | Avalia todas as regras | Avalia em sequ√™ncia (num√©rica) |

---

## ‚úÖ **2. AWS WAF e AWS Shield**
### üîπ **AWS WAF (Web Application Firewall)**
- **Protege aplica√ß√µes web** contra **ataques comuns** (SQL Injection, XSS, DDoS na camada de aplica√ß√£o).
- Usado com **ALB (Application Load Balancer), API Gateway, CloudFront e App Runner**.
- Define **WebACLs** com regras personalizadas.

üìå **Exemplo: Criando uma WebACL para bloquear SQL Injection**
```sh
aws wafv2 create-web-acl --name "MinhaWebACL" --scope "REGIONAL" --default-action Allow --rules '[
    {
        "Name": "BlockSQLInjection",
        "Priority": 1,
        "Statement": {
            "SqliMatchStatement": {
                "FieldToMatch": {
                    "AllQueryArguments": {}
                },
                "TextTransformations": [
                    {
                        "Priority": 0,
                        "Type": "URL_DECODE"
                    }
                ]
            }
        },
        "Action": {
            "Block": {}
        }
    }
]'
```
‚úÖ Isso bloqueia **SQL Injection** na requisi√ß√£o.

---

### üîπ **AWS Shield**
- Prote√ß√£o contra **ataques DDoS**.
- Dois n√≠veis:
  - **AWS Shield Standard** (gr√°tis) ‚Üí Prote√ß√£o autom√°tica contra ataques comuns.
  - **AWS Shield Advanced** (pago) ‚Üí Monitoramento 24/7, mitiga√ß√£o avan√ßada e suporte AWS.

‚úÖ **AWS Shield Standard** j√° protege **CloudFront, Route 53 e ALB** sem custo extra!

üìå **Resumo: AWS WAF vs AWS Shield**
| Servi√ßo | Protege contra | Aplicado em |
|---------|--------------|-------------|
| **AWS WAF** | SQL Injection, XSS, Bots, etc. | ALB, API Gateway, CloudFront |
| **AWS Shield** | DDoS | CloudFront, ALB, Route 53 |

---

## ‚úÖ **3. AWS Network Firewall**
- Firewall **gerenciado** dentro da **VPC**.
- Regras mais avan√ßadas que NACLs e Security Groups.
- Baseado no **Suricata** (poderoso sistema de detec√ß√£o de intrus√£o).
- Protege **tr√°fego Leste-Oeste (entre VPCs) e Norte-Sul (de/para internet)**.

üìå **Exemplo: Criando um AWS Network Firewall**
1Ô∏è‚É£ Criamos um firewall policy com regras personalizadas:
```sh
aws network-firewall create-firewall-policy --firewall-policy-name MeuFirewallPolicy --firewall-policy '{
    "StatelessRuleGroupReferences": [],
    "StatefulRuleGroupReferences": [],
    "StatefulDefaultActions": ["aws:drop_strict"]
}'
```
2Ô∏è‚É£ Criamos um firewall e associamos √† VPC:
```sh
aws network-firewall create-firewall --firewall-name MeuFirewall --firewall-policy-arn arn:aws:network-firewall:us-east-1:123456789012:firewall-policy/MeuFirewallPolicy --vpc-id vpc-12345678
```
‚úÖ O **AWS Network Firewall** protege redes corporativas e tr√°fego entre servi√ßos!

---

# üöÄ **Resumo Geral**
| Servi√ßo | Finalidade |
|---------|------------|
| **Security Groups** | Controle de tr√°fego a n√≠vel de inst√¢ncia (EC2, RDS). Stateful. |
| **NACLs** | Controle de tr√°fego a n√≠vel de subnet (VPC). Stateless. |
| **AWS WAF** | Protege contra ataques na camada de aplica√ß√£o (SQL Injection, XSS, Bots). |
| **AWS Shield** | Protege contra DDoS (Shield Standard √© gratuito, Advanced √© pago). |
| **AWS Network Firewall** | Firewall gerenciado para tr√°fego interno da VPC. |

---

Isso cobre toda a parte de **seguran√ßa de rede** na AWS! üî•  


Agora vamos falar sobre **Prote√ß√£o de Dados com Criptografia** na AWS! üîêüí°  

---

# üîπ **3. Prote√ß√£o de Dados com Criptografia**  

A criptografia √© essencial para garantir a seguran√ßa dos dados em repouso e em tr√¢nsito na AWS. Vamos cobrir os principais servi√ßos e t√©cnicas:

- **AWS KMS**: Gerenciamento de chaves de criptografia.  
- **AWS Secrets Manager & Parameter Store**: Armazenamento seguro de credenciais e segredos.  
- **Criptografia em repouso e em tr√¢nsito**: Prote√ß√£o de dados armazenados e transmitidos.  

---

## ‚úÖ **1. AWS KMS (Gerenciamento de Chaves de Criptografia)**  

O **AWS Key Management Service (KMS)** permite criar e gerenciar **chaves de criptografia** para proteger dados em diversos servi√ßos da AWS.

üìå **Principais Caracter√≠sticas do KMS**:
- Gera e gerencia **Customer Managed Keys (CMK)**.
- Integra√ß√£o com **S3, EBS, RDS, Lambda, DynamoDB e outros servi√ßos**.
- Usa **Hardware Security Modules (HSMs)** para seguran√ßa.
- **Auditoria via AWS CloudTrail**.

üìå **Exemplo: Criando uma chave KMS**
```sh
aws kms create-key --description "Minha Chave KMS"
```
üìå **Criptografando e descriptografando um dado**:
```sh
echo "Meu dado secreto" | aws kms encrypt --key-id "alias/minha-chave" --plaintext fileb://- --output text --query CiphertextBlob > data_encrypted.txt

aws kms decrypt --ciphertext-blob fileb://data_encrypted.txt --output text --query Plaintext | base64 --decode
```
‚úÖ Isso protege dados sens√≠veis usando uma **chave gerenciada pelo usu√°rio (CMK)**.

---

## ‚úÖ **2. AWS Secrets Manager e Parameter Store**  

A AWS oferece **dois servi√ßos** para armazenar **credenciais e segredos** com seguran√ßa:

### üîπ **AWS Secrets Manager**
- Armazena e gerencia **credenciais de banco de dados, API Keys, tokens, etc.**
- **Rota√ß√£o autom√°tica de credenciais** (exemplo: trocas peri√≥dicas de senhas do RDS).
- Integrado ao **AWS KMS** para criptografia.

üìå **Exemplo: Criando um segredo no Secrets Manager**
```sh
aws secretsmanager create-secret --name MeuBancoSenha --secret-string '{"username":"admin","password":"supersecreto"}'
```
üìå **Recuperando um segredo**
```sh
aws secretsmanager get-secret-value --secret-id MeuBancoSenha --query SecretString --output text
```
‚úÖ Isso protege credenciais sens√≠veis sem precisar armazen√°-las em c√≥digo.

---

### üîπ **AWS Systems Manager Parameter Store**
- Armazena **valores simples ou hier√°rquicos** (exemplo: `/prod/db/password`).
- Op√ß√£o de criptografia com **AWS KMS**.
- **Gratuito para par√¢metros padr√£o** (at√© 4 KB), enquanto **par√¢metros avan√ßados** t√™m custo.

üìå **Exemplo: Criando um par√¢metro no Parameter Store**
```sh
aws ssm put-parameter --name "/prod/db/password" --value "supersecreto" --type SecureString --key-id "alias/minha-chave"
```
üìå **Recuperando um par√¢metro seguro**
```sh
aws ssm get-parameter --name "/prod/db/password" --with-decryption
```
‚úÖ **Diferen√ßa entre Secrets Manager e Parameter Store**:

| Caracter√≠stica | Secrets Manager | Parameter Store |
|---------------|----------------|----------------|
| **Usado para** | Credenciais de banco, API Keys, tokens | Configura√ß√µes, senhas simples |
| **Rota√ß√£o autom√°tica** | Sim | N√£o |
| **Integra√ß√£o com KMS** | Sim | Sim |
| **Custo** | Pago | Gratuito para par√¢metros simples |

---

## ‚úÖ **3. Criptografia em Repouso e em Tr√¢nsito**  

A AWS protege dados **armazenados (em repouso)** e **enviados entre servi√ßos (em tr√¢nsito)**.

---

### üîπ **Criptografia em repouso (S3, RDS, EBS)**
üìå **Amazon S3**
- **Criptografia no lado do servidor (SSE)**:
  - **SSE-S3** ‚Üí AWS gerencia as chaves.
  - **SSE-KMS** ‚Üí Usa chaves gerenciadas no AWS KMS.
  - **SSE-C** ‚Üí Voc√™ fornece suas pr√≥prias chaves.
- **Criptografia no lado do cliente** ‚Üí Aplica√ß√£o criptografa antes de enviar.

üìå **Exemplo: Ativando criptografia ao enviar um arquivo para S3**
```sh
aws s3 cp meu-arquivo.txt s3://meu-bucket/ --sse aws:kms --sse-kms-key-id alias/minha-chave
```

üìå **Amazon RDS**
- Ativa-se no **momento da cria√ß√£o do banco**.
- Suporta criptografia para **Aurora, MySQL, PostgreSQL, SQL Server, MariaDB e Oracle**.

üìå **Exemplo: Criando um RDS criptografado**
```sh
aws rds create-db-instance --db-instance-identifier meu-db --engine mysql --master-username admin --master-user-password senha123 --storage-encrypted
```

üìå **Amazon EBS**
- **Volumes criptografados** protegem **EC2 e Snapshots**.
- **KMS gerencia as chaves**.

üìå **Exemplo: Criando um volume EBS criptografado**
```sh
aws ec2 create-volume --size 10 --region us-east-1 --availability-zone us-east-1a --encrypted --kms-key-id alias/minha-chave
```

‚úÖ **Resumo: Criptografia em repouso**
| Servi√ßo | Tipo de Criptografia |
|---------|----------------------|
| **S3** | SSE-S3, SSE-KMS, SSE-C, Criptografia do Cliente |
| **RDS** | Criptografia KMS (habilitada na cria√ß√£o) |
| **EBS** | Volumes e Snapshots criptografados com KMS |

---

### üîπ **Criptografia em tr√¢nsito (TLS)**
A AWS **usa TLS/SSL** para proteger a comunica√ß√£o entre servi√ßos e usu√°rios.

üìå **Como garantir comunica√ß√£o segura:**
1Ô∏è‚É£ **Habilitar HTTPS no S3**
```sh
aws s3api put-bucket-policy --bucket meu-bucket --policy '{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "EnforceTLS",
            "Effect": "Deny",
            "Principal": "*",
            "Action": "s3:*",
            "Resource": ["arn:aws:s3:::meu-bucket/*"],
            "Condition": {
                "Bool": {
                    "aws:SecureTransport": "false"
                }
            }
        }
    ]
}'
```
‚úÖ **Isso impede acessos n√£o seguros** (sem HTTPS).

2Ô∏è‚É£ **Ativar HTTPS no Load Balancer (ALB)**:
```sh
aws elbv2 create-listener --load-balancer-arn arn:aws:elasticloadbalancing:us-east-1:123456789012:loadbalancer/app/meu-alb --protocol HTTPS --port 443 --certificates CertificateArn=arn:aws:acm:us-east-1:123456789012:certificate/abcd-1234
```
‚úÖ **Isso garante que o tr√°fego passe por TLS**.

---

# üöÄ **Resumo Final**
| Recurso | Finalidade |
|---------|------------|
| **AWS KMS** | Gerencia chaves para criptografia de dados. |
| **AWS Secrets Manager** | Armazena credenciais e permite rota√ß√£o autom√°tica. |
| **AWS Parameter Store** | Armazena par√¢metros e segredos com criptografia. |
| **Criptografia em repouso** | Protege dados armazenados no **S3, RDS, EBS**. |
| **Criptografia em tr√¢nsito** | Usa **TLS/SSL** para proteger comunica√ß√µes. |

---

Isso cobre **criptografia e prote√ß√£o de dados na AWS**! üî•  

Bora para mais um t√≥pico essencial para a **SAA-C03**! üöÄ  

---

# üîπ **4. Pr√°ticas de Seguran√ßa para Banco de Dados e Armazenamento**  

A seguran√ßa de **bancos de dados e armazenamento** na AWS envolve **controle de acesso, autentica√ß√£o e pol√≠ticas** para proteger os dados.

- **Amazon RDS IAM Authentication** ‚Üí Gerenciamento de acesso seguro ao banco.  
- **Controle de acesso no S3** ‚Üí Uso de **Bucket Policies** e **Block Public Access** para restringir permiss√µes.  

---

## ‚úÖ **1. Amazon RDS IAM Authentication**  

O **Amazon RDS IAM Authentication** permite que usu√°rios se conectem ao banco de dados **sem precisar de senhas**, usando **credenciais tempor√°rias gerenciadas pelo IAM**.

üìå **Benef√≠cios do IAM Authentication no RDS**:
- **Elimina a necessidade de armazenar senhas** no c√≥digo.
- Usa **credenciais tempor√°rias** (STS) para conex√µes seguras.
- Funciona com **MySQL e PostgreSQL** no RDS e Aurora.

### üõ† **Passo a Passo: Configurar IAM Authentication no RDS**  

üîπ **1. Criar uma Role IAM para acesso ao RDS**  
```sh
aws iam create-role --role-name RDSIAMRole --assume-role-policy-document '{
  "Version": "2012-10-17",
  "Statement": {
    "Effect": "Allow",
    "Principal": {
      "Service": "rds.amazonaws.com"
    },
    "Action": "sts:AssumeRole"
  }
}'
```
  
üîπ **2. Criar uma Policy para permitir acesso ao banco**  
```sh
aws iam create-policy --policy-name RDSPolicy --policy-document '{
  "Version": "2012-10-17",
  "Statement": {
    "Effect": "Allow",
    "Action": "rds-db:connect",
    "Resource": "arn:aws:rds-db:us-east-1:123456789012:dbuser:my-db/iam_user"
  }
}'
```

üîπ **3. Associar a Policy ao usu√°rio**  
```sh
aws iam attach-user-policy --user-name meu-usuario --policy-arn arn:aws:iam::123456789012:policy/RDSPolicy
```

üîπ **4. Obter Token Tempor√°rio de Conex√£o**  
```sh
aws rds generate-db-auth-token --hostname mydb.cluster-xyz.us-east-1.rds.amazonaws.com --port 3306 --region us-east-1 --username iam_user
```
‚úÖ **Isso gera um token tempor√°rio para conex√£o ao banco!**  

üîπ **5. Conectar ao RDS com IAM Authentication**  
```sh
mysql --host=mydb.cluster-xyz.us-east-1.rds.amazonaws.com --user=iam_user --password=TOKEN_AQUI --ssl-ca=ca.pem
```
‚úÖ **Agora, o usu√°rio acessa o banco sem senha fixa, apenas com o token gerado pelo AWS STS.**  

---

## ‚úÖ **2. Controle de Acesso no S3**  

O **Amazon S3** oferece v√°rias maneiras de **proteger o acesso aos dados**, como **Bucket Policies** e **Block Public Access**.

### üîπ **Bucket Policies** (Pol√≠ticas de Acesso no S3)  
As **Bucket Policies** definem quem pode acessar um bucket e quais a√ß√µes s√£o permitidas.

üìå **Exemplo: Bloquear acesso p√∫blico ao bucket, exceto para um IP espec√≠fico**  
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Sid": "DenyPublicAccess",
      "Effect": "Deny",
      "Principal": "*",
      "Action": "s3:*",
      "Resource": ["arn:aws:s3:::meu-bucket/*"],
      "Condition": {
        "Bool": {"aws:SecureTransport": "false"}
      }
    },
    {
      "Sid": "AllowSpecificIP",
      "Effect": "Allow",
      "Principal": "*",
      "Action": "s3:GetObject",
      "Resource": ["arn:aws:s3:::meu-bucket/*"],
      "Condition": {
        "IpAddress": {"aws:SourceIp": "192.168.1.100/32"}
      }
    }
  ]
}
```
‚úÖ **Isso impede acessos n√£o seguros e s√≥ permite downloads de um IP espec√≠fico.**  

---

### üîπ **Block Public Access (BPA) no S3**  
A AWS oferece um controle global para impedir acessos p√∫blicos acidentais no S3.

üìå **Habilitar o Block Public Access via CLI**  
```sh
aws s3api put-public-access-block --bucket meu-bucket --public-access-block-configuration '{
  "BlockPublicAcls": true,
  "IgnorePublicAcls": true,
  "BlockPublicPolicy": true,
  "RestrictPublicBuckets": true
}'
```
‚úÖ **Isso garante que o bucket nunca ser√° acess√≠vel publicamente!**  

---

# üöÄ **Resumo Final**  

| üîπ Recurso | ‚úÖ Finalidade |
|------------|-------------|
| **Amazon RDS IAM Authentication** | Conectar ao banco **sem senha fixa**, usando credenciais tempor√°rias. |
| **Bucket Policies** | Controla **quem pode acessar os dados no S3** e o que podem fazer. |
| **Block Public Access (BPA)** | Bloqueia **acesso p√∫blico n√£o intencional** ao bucket. |

---

üî• **Isso cobre pr√°ticas de seguran√ßa para bancos de dados e armazenamento na AWS!**  
